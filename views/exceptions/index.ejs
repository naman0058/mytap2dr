<%- include('../layout.ejs') %>

<h2>Exceptions</h2>
<p><a href="/exceptions/new">+ Add Exception</a></p>

<table>
  <thead>
    <tr><th>Date</th><th>Doctor</th><th>City</th><th>Closed?</th><th>Start</th><th>End</th><th>Reason</th><th></th></tr>
  </thead>
  <tbody>
  <% rows.forEach(r => { %>
    <tr>
      <td><%= r.exception_date.toISOString().slice(0,10) %></td>
      <td><%= r.doctor_name %></td>
      <td><%= r.city %></td>
      <td><%= r.is_closed ? 'Yes' : 'No' %></td>
      <td><%= r.start_time || '-' %></td>
      <td><%= r.end_time || '-' %></td>
      <td><%= r.reason || '-' %></td>
      <td class="actions">
        <a href="/exceptions/<%= r.exception_id %>">View</a>
        <a href="/exceptions/<%= r.exception_id %>/edit">Edit</a>
        <form action="/exceptions/<%= r.exception_id %>?_method=DELETE" method="post" onsubmit="return confirm('Delete exception?');">
          <button>Delete</button>
        </form>
      </td>
    </tr>
  <% }) %>
  </tbody>
</table>
